/*! Protected Content - v1.1.0
 * https://premium.wpmudev.org/project/membership/
 * Copyright (c) 2015; * Licensed GPLv2+ */
window.ms_init=window.ms_init||{},jQuery(function(){function e(e){if(void 0!==e&&void 0!==window.ms_init[e]){if(!0===window.ms_init._done[e])return!1;window.ms_init._done[e]=!0,window.ms_init[e]()}}var t;if(window.ms_init._done=window.ms_init._done||{},void 0!==window.ms_data&&void 0!==ms_data.ms_init){if(ms_data.ms_init instanceof Array)for(t=0;ms_data.ms_init.length>t;t+=1)e(ms_data.ms_init[t]);else e(ms_data.ms_init);ms_data.ms_init=[]}}),window.ms_functions={dp_config:{dateFormat:"yy-mm-dd",dayNamesMin:["Sun","Mon","Tue","Wed","Thy","Fri","Sat"],custom_class:"wpmui-datepicker"},chosen_options:{minimumResultsForSearch:6,dropdownAutoWidth:!0,dropdownCssClass:"ms-select2",containerCssClass:"ms-select2"},init:function(e){var t=window.ms_functions;jQuery(".ms-wrap select, .ms-wrap .chosen-select",e).each(function(){var e=jQuery(this);e.closest(".no-auto-init").length||e.closest(".manual-init").length||e.select2(t.chosen_options)}),jQuery(".wpmui-datepicker",e).ms_datepicker()},ajax_update:function(e){var t,i,s,a=jQuery(e),r=window.ms_functions,n=a;a.hasClass("ms-processing")||(n.parents(".wpmui-radio-wrapper").length?n=n.parents(".wpmui-radio-wrapper").first():n.parents(".wpmui-radio-slider-wrapper").length?n=n.parents(".wpmui-radio-slider-wrapper").first():n.parents(".wpmui-input-wrapper").length?n=n.parents(".wpmui-input-wrapper").first():n.parents("label").length&&(n=n.parents("label").first()),n.addClass("wpmui-loading"),s=r.ajax_show_indicator(a),t=a.data("ajax"),a.is(":checkbox")?t.value=a.prop("checked"):(i=a.val(),i instanceof Array||i instanceof Object||null===i?t.values=i:t.value=i),"function"==typeof a.data("before_ajax")&&(t=a.data("before_ajax")(t,a)),a.trigger("ms-ajax-start",[t,s,n]),jQuery.post(window.ajaxurl,t,function(e){var i=r.ajax_error(e,s);n.removeClass("wpmui-loading"),s.removeClass("ms-processing"),a.trigger("ms-ajax-updated",[t,e,i])}).always(function(){a.trigger("ms-ajax-done",[t,s,n])}))},radio_slider_ajax_update:function(e){var t,i,s,a,r,n=jQuery(e),o=window.ms_functions;n.hasClass("ms-processing")||n.attr("readonly")||(n.toggleClass("on"),n.parent().toggleClass("on"),n.trigger("change"),s=n.children(".wpmui-toggle"),t=s.data("ajax"),a=s.data("states"),null!==t&&void 0!==t?(i=o.ajax_show_indicator(n),n.addClass("ms-processing wpmui-loading"),r=n.hasClass("on"),t.value=void 0!==a.active&&r?a.active:void 0===a.inactive||r?r:a.inactive,"function"==typeof n.data("before_ajax")&&(t=n.data("before_ajax")(t,n)),n.trigger("ms-ajax-start",[t,i,n]),jQuery.post(window.ajaxurl,t,function(e){var s=o.ajax_error(e,i);s&&n.toggleClass("on"),i.removeClass("ms-processing"),n.removeClass("ms-processing wpmui-loading"),n.children("input").val(n.hasClass("on")),t.response=e,n.trigger("ms-ajax-updated",[t,e,s]),n.trigger("ms-radio-slider-updated",[t,s]),n.trigger("wpmui-radio-slider-updated",[t,s])}).always(function(){n.trigger("ms-ajax-done",[t,i,n])})):n.children("input").val(n.hasClass("on")))},dynamic_form_submit:function(e,t){var i,s,a,r,n,o,u=window.ms_functions,d=jQuery(t),l=d.serializeArray(),m={};for(e.preventDefault(),i=0;l.length>i;i+=1)a=l[i].name,s=l[i].value,void 0===m[a]?m[a]=s:(!m[a]instanceof Array&&(m[a]=[m[a]]),m[a].push(s));return m.action="ms_submit",o=d.parents(".wpmui-wnd"),r=o.length,r?o.addClass("wpmui-loading"):n=u.ajax_show_indicator(d),jQuery(document).trigger("ms-ajax-form-send",[d,m,r,n]),jQuery.post(window.ajaxurl,m,function(e){var t=u.ajax_error(e,n);o.length&&o.removeClass("wpmui-loading"),t||r&&u.close_dialogs(),jQuery(document).trigger("ms-ajax-form-done",[d,e,t,m,r,n])}),!1},ajax_error:function(e,t){var i=0,s=[],a="",r=window.ms_functions;return isNaN(e)?(s=e.split(":",2),isNaN(s[0])||(i=s[0]),void 0!==s[1]&&(a=s[1])):i=e,0>i?(t&&(t.removeClass("okay").addClass("error"),t.find(".err-code").text(a),r.ajax_hide_message(8e3,t)),!0):(t&&(t.removeClass("error").addClass("okay"),t.find(".err-code").text(""),r.ajax_hide_message(4e3,t)),!1)},ajax_show_indicator:function(e){var t;return window.ms_functions,t=e.nearest(".ms-save-text-wrapper"),null!==t.data("msg_timeout")&&(window.clearTimeout(t.data("msg_timeout")),t.data("msg_timeout",null)),t.addClass("ms-processing"),t.removeClass("error okay"),t},ajax_hide_message:function(e,t){var i;window.ms_functions,isNaN(e)&&(e=4e3),0>e&&(e=0),i=window.setTimeout(function(){var e=t;e.removeClass("error okay")},e),t.data("msg_timeout",i)},select_all:function(e){var t;e=jQuery(e)[0],document.selection?(t=document.body.createTextRange(),t.moveToElementText(e),t.select()):window.getSelection&&(t=document.createRange(),t.selectNode(e),window.getSelection().addRange(t))},toggle_box:function(e,t){var i=jQuery(t),s=i.closest(".ms-settings-box");return s.hasClass("static")?!1:(s.hasClass("closed")?s.removeClass("closed").addClass("open"):s.removeClass("open").addClass("closed"),void 0)},toggle_datepicker:function(e){var t=jQuery(e),i=t.closest(".wpmui-datepicker-wrapper").find(".wpmui-datepicker");i.datepicker("show")},tag_selector_add:function(e){var t=window.ms_functions,i=jQuery(this).closest(".wpmui-tag-selector-wrapper"),s=i.find("select.wpmui-tag-source"),a=i.find("select.wpmui-tag-data"),r=a.val()||[];s.val().length&&(r.push(s.val()),a.val(r).trigger("change"),s.val("").trigger("change"),t.tag_selector_refresh_source(e,this))},tag_selector_refresh_source:function(e,t){var i=0,s=null,a=jQuery(t).closest(".wpmui-tag-selector-wrapper"),r=a.find("select.wpmui-tag-source"),n=r.find("option"),o=a.find("select.wpmui-tag-data"),u=o.val()||[];for(i=0;n.length>i;i+=1)s=jQuery(n[i]),-1!==jQuery.inArray(s.val(),u)?s.prop("disabled",!0):s.prop("disabled",!1);r.trigger("change")},reload:function(){window.location.reload()},show_dialog:function(e){var t,i=jQuery(this),s=(window.ms_functions,{});if(e.preventDefault(),t=i.attr("data-ms-data"),void 0!==t)try{s=jQuery.parseJSON(t)}catch(a){s={}}return s.action="ms_dialog",s.dialog=i.attr("data-ms-dialog"),jQuery(document).trigger("ms-load-dialog",[s]),i.addClass("wpmui-loading"),jQuery.post(window.ajaxurl,s,function(e){var t,s=!1;i.removeClass("wpmui-loading");try{s=jQuery.parseJSON(e)}catch(a){s=!1}s.title=s.title||"Dialog",s.height=s.height||100,s.content=s.content||"",s.modal=s.modal||!0,t=wpmUi.popup().modal(!0,!s.modal).title(s.title).size(void 0,s.height).content(s.content).show()}),!1},close_dialogs:function(){var e,t=wpmUi.popups();for(e in t)t[e].close()},update_view_count:function(e,t){var i=jQuery(this),s=i.closest(".wp-list-table"),a=s.closest("form"),r=a.parent(),n=r.find(".subsubsub").first(),o=n.find(".has_access .count"),u=n.find(".no_access .count"),d=parseInt(o.text().replace(/\D/,"")),l=parseInt(u.text().replace(/\D/,""));isNaN(d)&&(d=0),isNaN(l)&&(l=0),t.value?(l-=1,d+=1):(l+=1,d-=1),0>d&&(d=0),0>l&&(l=0),0===d?o.text(""):o.text("("+d+")"),0===l?u.text(""):u.text("("+l+")")},submit_form:function(){var e=jQuery(this),t=e.data("form"),i=jQuery("form."+t);i.length&&i.submit()}},jQuery.fn.ms_datepicker=function(e){var t=null,i=window.ms_functions,s=jQuery.extend(i.dp_config,e);return"function"==typeof s.beforeShow&&(t=s.beforeShow),s.beforeShow=function(e,i){void 0!==i&&void 0!==i.dpDiv&&jQuery(i.dpDiv).addClass(s.custom_class),null!==t&&t(e,i)},this.each(function(){jQuery(this).datepicker(s)})},jQuery(document).ready(function(){var e=window.ms_functions;jQuery("body").on("click",".wpmui-radio-slider",function(){e.radio_slider_ajax_update(this)}).on("click",".ms-settings-box .handlediv",function(t){e.toggle_box(t,this)}).on("click",".wpmui-datepicker-wrapper .wpmui-icon",function(){e.toggle_datepicker(this)}).on("select2-opening",".wpmui-tag-selector-wrapper .wpmui-tag-data",function(e){e.preventDefault()}).on("change",".wpmui-tag-selector-wrapper .wpmui-tag-data",function(t){e.tag_selector_refresh_source(t,this)}).on("click",".wpmui-tag-selector-wrapper .wpmui-tag-button",e.tag_selector_add).on("change","input.wpmui-ajax-update, select.wpmui-ajax-update, textarea.wpmui-ajax-update",function(){e.ajax_update(this)}).on("click","button.wpmui-ajax-update",function(){e.ajax_update(this)}).on("submit","form.wpmui-ajax-update",function(t){e.dynamic_form_submit(t,this)}).on("click","[data-ms-dialog]",e.show_dialog).on("ms-radio-slider-updated",".wp-list-table.rules .wpmui-radio-slider",e.update_view_count).on("click",".ms-submit-form",e.submit_form),jQuery(".ms-wrap").on("click","code",function(){e.select_all(this)}),e.init("body")}),jQuery(function(){jQuery(document).click(function(){function e(){var e=jQuery(this),t=e.attr("timestamp"),i=jQuery('.wpmui-tooltip-wrapper[timestamp="'+t+'"]').first();e.hide(),e.appendTo(jQuery(i))}jQuery(".wpmui-tooltip[timestamp]").each(e)}),jQuery(".wpmui-tooltip-button").click(function(){var e=jQuery(this),t=e.parents(".wpmui-tooltip"),i=jQuery(t).attr("timestamp"),s=jQuery('.wpmui-tooltip-wrapper[timestamp="'+i+'"]').first();jQuery(t).hide(),jQuery(t).appendTo(jQuery(s))}),jQuery(".wpmui-tooltip").click(function(e){e.stopPropagation()}),jQuery(".wpmui-tooltip-info").click(function(e){var t,i,s,a,r,n=jQuery(this);n.toggleClass("open"),n.hasClass("open")?(n.parents(".wpmui-tooltip-wrapper").attr("timestamp",e.timeStamp),e.stopPropagation(),r=n.siblings(".wpmui-tooltip"),r.attr("timestamp",e.timeStamp),a=n.offset(),r.appendTo("#wpcontent"),r.css({left:a.left+25,top:a.top-40}),r.fadeIn(300)):(t=n.parents(".wpmui-tooltip-wrapper"),i=jQuery(t).attr("timestamp"),s=jQuery('.wpmui-tooltip[timestamp="'+i+'"]').first(),jQuery(s).hide(),jQuery(s).appendTo(jQuery(t)))})}),window.ms_init.controller_adminbar=function(){function e(e){var t=e.currentTarget.value,i=jQuery("#wpadminbar #view-as-selector").find('option[value="'+t+'"]').attr("nonce");jQuery("#wpadminbar #ab-membership-id").val(t),jQuery("#wpadminbar #view-site-as #_wpnonce").val(i),jQuery("#wpadminbar #view-site-as").submit()}jQuery("#wp-admin-bar-membership-simulate").find("a").click(function(){jQuery("#wp-admin-bar-membership-simulate").removeClass("hover").find("> div").filter(":first-child").html(ms_data.switching_text)}),jQuery(".ms-date").ms_datepicker(),jQuery("#wpadminbar #view-site-as").parents("#wpadminbar").addClass("simulation-mode"),jQuery("#wpadminbar #view-as-selector").change(e)},window.ms_init.view_help=function(){function e(){var e=jQuery(this),t=e.parents(".ms-help-box").first(),i=t.find(".ms-help-details");i.toggle()}jQuery(".ms-help-toggle").click(e)},window.ms_init.view_billing_edit=function(){var e={onkeyup:!1,errorClass:"ms-validation-error",rules:{name:"required",user_id:{required:!0,min:1},membership_id:{required:!0,min:1},amount:{required:!0,min:0},due_date:{required:!0,dateISO:!0}}};jQuery(".ms-form").validate(e)},window.ms_init.view_member_date=function(){jQuery(".ms-date").ms_datepicker()},window.ms_init.view_member_list=function(){function e(){"membership"===jQuery("#search_options").val()?(jQuery("#membership_filter").show(),jQuery("#member-search").hide()):(jQuery("#membership_filter").hide(),jQuery("#member-search").show())}function t(){var e=jQuery("#new_member").val();return e.length?(jQuery("#form_add_member").submit(),void 0):!1}function i(){var e=jQuery("#new_member").val();e.length?jQuery("#add_member").removeClass("disabled"):jQuery("#add_member").addClass("disabled")}function s(){var e=jQuery("#view_membership"),t=parseInt(e.val()),i=e.data("ajax"),s=i.url+t;0>=t||(window.location=s)}var a=jQuery.extend({},window.ms_functions.chosen_options);jQuery("#search_options").change(e),e(),a.minimumResultsForSearch=0,a.placeholder=window.ms_data.lang.select_user,a.allowClear=!0,a.multiple=!0,a.minimumInputLength=1,a.closeOnSelect=!1,a.ajax={url:window.ajaxurl,dataType:"jsonp",cache:!0,quietMillis:500,data:function(e){return{filter:e,action:"get_users"}},results:function(e){return{results:e}}},jQuery("#new_member").select2(a).change(i),jQuery("#add_member").click(t),i(),jQuery("#view_membership").change(s)},window.ms_init.view_membership_add=function(){var e=jQuery("input#public"),t=e.closest(".opt"),i=jQuery("input#paid"),s=i.closest(".opt");jQuery("#ms-choose-type-form").validate({onkeyup:!1,errorClass:"ms-validation-error",rules:{name:{required:!0}}}),jQuery('input[name="type"]').click(function(){var a=jQuery('input[name="type"]'),r=a.filter(":checked"),n=r.val();a.closest(".wpmui-radio-input-wrapper").removeClass("active"),r.closest(".wpmui-radio-input-wrapper").addClass("active"),"guest"===n?(e.prop("disabled",!0),i.prop("disabled",!0),t.addClass("disabled ms-locked"),s.addClass("disabled ms-locked")):(e.prop("disabled",!1),i.prop("disabled",!1),t.removeClass("disabled ms-locked"),s.removeClass("disabled ms-locked"))}).first().trigger("click"),jQuery("#cancel").click(function(){var e=jQuery(this);e.on("ms-ajax-updated",function(){window.location=ms_data.initial_url}),ms_functions.ajax_update(e)})},window.ms_init.view_membership_list=function(){function e(e){var t,i=jQuery(this),s=i.parents("tr"),a=s.find(".column-name .the-name").text(),r=i.attr("href");return e.preventDefault(),t={message:ms_data.lang.msg_delete.replace("%s",a),buttons:[ms_data.lang.btn_delete,ms_data.lang.btn_cancel],callback:function(e){0===e&&(window.location=r)}},wpmUi.confirm(t),!1}var t=jQuery("#the-list-membership");t.on("click",".delete a",e),jQuery(document).on("ms-ajax-form-done",function(e,t,i,s){s||window.location.reload()})},window.ms_init.metabox=function(){jQuery(".ms-protect-content").hasClass("on")?jQuery("#ms-metabox-access-wrapper").show():jQuery("#ms-metabox-access-wrapper").hide(),jQuery(".dripped").click(function(){var e=jQuery(this).children(".tooltip");e.toggle(300)}),window.ms_init.ms_metabox_event=function(e,t){jQuery("#ms-metabox-wrapper").replaceWith(t.response),window.ms_init.ms_metabox(),jQuery(".wpmui-radio-slider").click(function(){window.ms_functions.radio_slider_ajax_update(this)}),jQuery(".ms-protect-content").on("ms-radio-slider-updated",function(e,t){window.ms_init.ms_metabox_event(e,t)})},jQuery(".ms-protect-content").on("ms-radio-slider-updated",function(e,t){window.ms_init.ms_metabox_event(e,t)})},window.ms_init.view_membership_overview=function(){jQuery(".wpmui-radio-slider").on("ms-radio-slider-updated",function(){var e=this,t=jQuery("#ms-membership-status");jQuery(e).hasClass("on")?t.addClass("ms-active"):t.removeClass("ms-active")}),jQuery(document).on("ms-ajax-form-done",function(e,t,i,s){s||window.location.reload()})},window.ms_init.view_membership_urlgroup=function(){var e=!1;ms_functions.test_url=function(){e&&window.clearTimeout(e),e=window.setTimeout(function(){var e=jQuery("#url-test-results-wrapper"),t=jQuery.trim(jQuery("#url_test").val()),i=jQuery("#rule_value").val().split("\n"),s=jQuery("#is_regex").val();s="true"===s||"1"===s?!0:!1,e.empty().hide(),""!==t&&(jQuery.each(i,function(i,a){var r,n,o,u,d;a=jQuery.trim(a),""!==a&&(r=jQuery("<div />").addClass("ms-rule-test"),o=jQuery("<span />").appendTo(r).text(a).addClass("ms-test-url"),n=jQuery("<span />").appendTo(r).addClass("ms-test-result"),d=!1,s?(u=RegExp(a,"i"),d=u.test(t)):d=t.indexOf(a)>=0,d?(r.addClass("ms-rule-valid"),n.text(ms_data.valid_rule_msg)):(r.addClass("ms-rule-invalid"),n.text(ms_data.invalid_rule_msg)),e.append(r))}),e.find("> div").length||e.html("<div><i>"+ms_data.empty_msg+"</i></div>"),e.show())},500)},jQuery("#url_test, #rule_value").keyup(ms_functions.test_url)},window.ms_init.view_membership_dripped=function(){ms_functions.change_dripped_type=function(e){var t=jQuery(e).val();jQuery(".ms-dripped-edit-wrapper").hide(),jQuery(".ms-dripped-type-"+t).show()},ms_functions.change_access=function(e,t){jQuery('input[name="dripped_type"]:checked').val(),e?jQuery(t).parent().parent().find(".dripped.column-dripped").css("visibility","visible"):jQuery(t).parent().parent().find(".dripped.column-dripped").css("visibility","hidden")},jQuery('input[name="dripped_type"]').change(function(){ms_functions.change_dripped_type(this)}),jQuery(".ms-dripped-spec-date").ms_datepicker(),ms_functions.change_dripped_type(jQuery('input[name="dripped_type"]:checked')),jQuery(".ms-dripped-calendar").click(function(){jQuery(this).parent().find(".ms-dripped-spec-date.wpmui-ajax-update").datepicker("show")}),jQuery(".ms-period-desc-wrapper").click(function(){jQuery(this).parent().addClass("ms-dripped-edit")}),jQuery("input.ms-dripped-edit-ok").click(function(){var e,t;jQuery(this).parent().parent().removeClass("ms-dripped-edit"),e=jQuery(this).parent().find("input"),t=jQuery(this).parent().find("select"),e.change(),t.change(),jQuery(this).parent().parent().find(".ms-period-unit").text(e.val()),jQuery(this).parent().parent().find(".ms-period-type").text(t.val())}),jQuery(".wpmui-radio-slider").on("ms-radio-slider-updated",function(e,t){ms_functions.change_access(t.value,e.target)}),jQuery(".wpmui-radio-slider").each(function(){var e=jQuery(this).children("input").val()?1:0;ms_functions.change_access(e,this)})},window.ms_init.view_membership_payment=function(){function e(){var e=jQuery(this),t=e.closest(".inside"),i=e.val(),s=t.find(".ms-payment-type-wrapper"),a=t.find(".ms-payment-type-"+i),r=t.find(".ms-after-end-wrapper");s.hide(),a.show(),"permanent"===i?r.hide():r.show()}function t(){var e=jQuery(this).val(),t=jQuery(".ms-payment-structure-wrapper");switch(e){case"USD":e="$";break;case"EUR":e="&euro;";break;case"JPY":e="&yen;"}t.find(".wpmui-field-description").html(e)}function i(e,t){t.value?jQuery(".ms-trial-period-details").show():jQuery(".ms-trial-period-details").hide()}jQuery("#payment_type").change(e),jQuery("#payment_type").each(e),jQuery("#currency").change(t),jQuery(".wpmui-slider-trial_period_enabled").on("ms-radio-slider-updated",i)},window.ms_init.view_protected_content=function(){function e(){var e=jQuery(this).closest(".column-access");e.find(".ms-public").removeClass("ms-public").addClass("ms-protected ms-focused").find("select.ms-memberships").select2("focus").select2("open")}function t(){var e=jQuery(this).closest(".column-access"),t=e.find("select.ms-memberships"),i=t.select2("val");e.find(".ms-focused").removeClass("ms-focused"),i&&i.length||(window.console.log("MAKE ROW PUBLIC:",t,i),e.find(".ms-protected").removeClass("ms-protected").addClass("ms-public"))}function i(e){var t,i=e.element;return t='class="val" style="background: '+jQuery(i).data("color")+'"',"<span "+t+">&emsp;</span> "+e.text}function s(e){var t,i=e.element;return t='class="val" style="background: '+jQuery(i).data("color")+'"',"<span "+t+'><span class="txt">'+e.text+"</span></span>"}var a=jQuery(".wp-list-table");a.on("click",".ms-public-note-wrapper .wpmui-label-after",e),a.on("ms-ajax-updated",".ms-memberships",t),a.on("blur",".ms-memberships",function(e){var i=jQuery(this);window.setTimeout(function(){t.apply(i,e)},250)}),jQuery("select.ms-memberships").select2({formatResult:i,formatSelection:s,escapeMarkup:function(e){return e},dropdownCssClass:"ms-memberships"})},window.ms_init.view_settings=function(){function e(){var e=jQuery("select.wpmui-wp-pages"),t=e.map(function(){return jQuery(this).val()});e.each(function(){var e,i=jQuery(this),s=i.find("option"),a=i.parents(".ms-settings-page-wrapper").first(),r=a.find(".ms-action a"),n=i.val();for(s.prop("disabled",!1),e=0;t.length>e;e+=1)n!==t[e]&&s.filter('[value="'+t[e]+'"]').prop("disabled",!0);r.each(function(){var e=jQuery(this),t=e.data("ajax"),i=t.base+n;void 0===n||isNaN(n)||1>n?(e.addClass("disabled"),e.attr("href","")):(e.removeClass("disabled"),e.attr("href",i))})})}function t(e){var t=jQuery(this);return t.hasClass("disabled")||!t.attr("href").length?(e.preventDefault(),!1):void 0}function i(){jQuery("#ms-comm-type-form").submit()}function s(){window.location=ms_data.initial_url}function a(e,t){t.value?(jQuery("#wp-admin-bar-ms-unprotected").hide(),jQuery("#wp-admin-bar-ms-test-memberships").show()):(jQuery("#wp-admin-bar-ms-unprotected").show(),jQuery("#wp-admin-bar-ms-test-memberships").hide())}jQuery("#initial_setup").on("ms-ajax-updated",s),jQuery(".wpmui-slider-plugin_enabled").on("ms-radio-slider-updated",a),jQuery(".wpmui-wp-pages").on("ms-ajax-updated",e),jQuery(".ms-action a").on("click",t),jQuery(function(){e()}),jQuery("#comm_type").change(i)},window.ms_init.view_addons=function(){function e(e,t,i){switch(t){case"options":i.hide().filter(".ms-options").show()}}function t(e,t,i,s){s.removeClass("wpmui-loading"),a.addClass("wpmui-loading")}function i(){a.removeClass("wpmui-loading")}function s(e){var t=jQuery(e.target),i=t.closest(".list-card-top"),s=i.find(".details"),a=s.find(".wpmui-ajax-update-wrapper");t.closest(".details").length||(t.hasClass("on")?a.removeClass("disabled"):a.addClass("disabled"))}var a=jQuery(".ms-addon-list");jQuery(document).on("list-filter",e),jQuery(document).on("ms-ajax-start",t),jQuery(document).on("ms-ajax-updated",s),jQuery(document).on("ms-ajax-done",i),jQuery(".list-card-top .wpmui-ajax-update-wrapper").each(function(){jQuery(this).trigger("ms-ajax-updated")})},window.ms_init.view_settings_automated_msg=function(){var e=!1;jQuery("#switch_comm_type").click(function(){var t=jQuery(this),i=t.closest("form"),s=0;for(s=0;window.tinymce.editors.length>s;s+=1)if(window.tinymce.editors[s].isDirty()){e=!0;break}return e&&!window.confirm(ms_data.lang_confirm)?!1:(i.submit(),void 0)}),jQuery("input, select, textarea",".ms-editor-form").change(function(){e=!0}),window.tinymce.PluginManager.add("ms_variable",function(e){function t(){e.insertContent(this.value())}var i,s,a=[];for(i in ms_data.var_button.items)ms_data.var_button.items.hasOwnProperty(i)&&(s=ms_data.var_button.items[i],a.push({text:s,value:i,onclick:t}));e.addButton("ms_variable",{text:ms_data.var_button.title,icon:!1,type:"menubutton",menu:a})})},window.ms_init.view_settings_mailchimp=function(){jQuery("#mailchimp_api_key").on("ms-ajax-updated",ms_functions.reload)},window.ms_init.view_settings_payment=function(){function e(e,t,i,s,a){var r=jQuery(".gateway-"+a.gateway_id);s||(r.removeClass("not-configured").addClass("is-configured"),void 0!==a.mode&&"sandbox"===a.mode?r.removeClass("is-live").addClass("is-sandbox"):r.removeClass("is-sandbox").addClass("is-live"))}jQuery(document).on("ms-ajax-form-done",e)},window.ms_init.view_settings_protection=function(){function e(e){var t=jQuery("#"+e.type),i=t.closest(".wp-editor-wrap"),s=window.tinyMCE.get(e.type);return s&&i.hasClass("tmce-active")&&s.save(),e.value=t.val(),e}jQuery(".button-primary.wpmui-ajax-update").data("before_ajax",e)};